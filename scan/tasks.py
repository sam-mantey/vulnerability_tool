from .data import data

data_dict = {item['name']: item for item in data}

def update_alerts_with_json(alerts):
    for alert in alerts:
        alert_name = alert.get('name')
        if alert_name in data_dict:
            alert['description'] = data_dict[alert_name]['description']
            alert['solution'] = data_dict[alert_name]['solution']
    return alerts

def group_risks(report_result):
    high_risk_alerts = []
    medium_risk_alerts = []
    low_risk_alerts = []
    informational_alerts = []

    # Update alerts with data from JSON
    updated_report_result = update_alerts_with_json(report_result)

    for alert in updated_report_result:
        risk_level = alert.get('risk')
        if risk_level == 'High':
            high_risk_alerts.append(alert)
        elif risk_level == 'Medium':
            medium_risk_alerts.append(alert)
        elif risk_level == 'Low':
            low_risk_alerts.append(alert)
        elif risk_level == 'Informational':
            informational_alerts.append(alert)
    
    return [high_risk_alerts, medium_risk_alerts, low_risk_alerts, informational_alerts]



# def group_risks(report_result):
#     high_risk_alerts = []
#     medium_risk_alerts = []
#     low_risk_alerts = []
#     informational_alerts = []

#     for alert in report_result:
#         risk_level = alert.get('risk')
#         if risk_level == 'High':
#             high_risk_alerts.append(alert)
#         elif risk_level == 'Medium':
#             medium_risk_alerts.append(alert)
#         elif risk_level == "Low":
#             low_risk_alerts.append(alert)
#         elif risk_level == 'Informational':
#             informational_alerts.append(alert)
    
#     return [high_risk_alerts, medium_risk_alerts, low_risk_alerts, informational_alerts]

